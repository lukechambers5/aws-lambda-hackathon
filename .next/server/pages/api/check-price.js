"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/check-price";
exports.ids = ["pages/api/check-price"];
exports.modules = {

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheck-price&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheck-price.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheck-price&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheck-price.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_check_price_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\check-price.ts */ \"(api-node)/./pages/api/check-price.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_check_price_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_check_price_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/check-price\",\n        pathname: \"/api/check-price\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_check_price_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGY2hlY2stcHJpY2UmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2NoZWNrLXByaWNlLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUErRjtBQUN2QztBQUNFO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxzREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsc0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IseUdBQW1CO0FBQ2xEO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcY2hlY2stcHJpY2UudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgJ2RlZmF1bHQnKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsICdjb25maWcnKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoZWNrLXByaWNlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2hlY2stcHJpY2VcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiAnJyxcbiAgICAgICAgZmlsZW5hbWU6ICcnXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheck-price&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheck-price.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/check-price.ts":
/*!**********************************!*\
  !*** ./pages/api/check-price.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _utils_retail_fallback__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/retail_fallback */ \"(api-node)/./utils/retail_fallback.ts\");\n\nasync function handler(req, res) {\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            error: 'Method Not Allowed'\n        });\n    }\n    const { set_num, condition } = req.body;\n    if (!set_num || !condition) {\n        return res.status(400).json({\n            error: 'Missing set_num or condition'\n        });\n    }\n    try {\n        // ðŸ” Step 1: Try to fetch from DynamoDB (via Lambda)\n        const response = await fetch('https://klkwwthdl7.execute-api.us-east-2.amazonaws.com/CheckPrice', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                set_num,\n                condition\n            })\n        });\n        const responseText = await response.text();\n        let data;\n        try {\n            data = JSON.parse(responseText);\n        } catch (err) {\n            console.error(\"Failed to parse JSON from Lambda:\", err);\n            return res.status(500).json({\n                error: \"Invalid JSON from Lambda\"\n            });\n        }\n        const samples = data?.data?.price_samples;\n        // If no result or empty samples, fallback to BrickEconomy\n        if (!response.ok || !samples || samples.length === 0) {\n            let fallback = await (0,_utils_retail_fallback__WEBPACK_IMPORTED_MODULE_0__.get_retail_value)(set_num, condition);\n            if (fallback) {\n                let fallbackPrice = 0;\n                if (fallback.marketPrice != null) {\n                    fallbackPrice = fallback.marketPrice;\n                }\n                if (fallbackPrice == 0) {\n                    fallback = await (0,_utils_retail_fallback__WEBPACK_IMPORTED_MODULE_0__.get_retail_value)(set_num, \"new\");\n                    fallbackPrice = fallback?.marketPrice ? fallback.marketPrice * 0.8 : 0;\n                }\n                const storeResponse = await fetch('https://klkwwthdl7.execute-api.us-east-2.amazonaws.com/CheckPrice', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        store: true,\n                        set_num,\n                        condition,\n                        name: fallback.meta.name,\n                        year: fallback.meta.year,\n                        price_samples: [\n                            {\n                                date: new Date().toISOString().split('T')[0],\n                                value: Number(fallbackPrice.toFixed(2))\n                            }\n                        ]\n                    })\n                });\n                const storeResult = await storeResponse.text();\n                return res.status(200).json({\n                    message: 'Fallback price used',\n                    data: {\n                        set_num,\n                        condition,\n                        name: fallback.meta.name,\n                        year: fallback.meta.year,\n                        price_samples: [\n                            {\n                                date: new Date().toISOString().split('T')[0],\n                                value: Number(fallbackPrice.toFixed(2))\n                            }\n                        ]\n                    }\n                });\n            }\n            return res.status(500).json({\n                error: 'Unable to fetch fallback price'\n            });\n        }\n        // âœ… If price samples exist, return normal data\n        return res.status(200).json(data);\n    } catch (error) {\n        console.error('Error in check-price API:', error);\n        return res.status(500).json({\n            error: 'Server error'\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsT0FBT3JDLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLE9BQU87WUFBaUM7UUFDeEU7UUFFQSwrQ0FBK0M7UUFDL0MsT0FBT0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQ1k7SUFFOUIsRUFBRSxPQUFPWCxPQUFPO1FBQ2RjLFFBQVFkLEtBQUssQ0FBQyw2QkFBNkJBO1FBQzNDLE9BQU9KLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFlO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbHVrZWNcXE9uZURyaXZlXFxEZXNrdG9wXFxBV1MgSGFja2F0aG9uXFxwYWdlc1xcYXBpXFxjaGVjay1wcmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IHsgZ2V0X3JldGFpbF92YWx1ZSB9IGZyb20gJy4uLy4uL3V0aWxzL3JldGFpbF9mYWxsYmFjayc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2QgTm90IEFsbG93ZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgeyBzZXRfbnVtLCBjb25kaXRpb24gfSA9IHJlcS5ib2R5O1xyXG5cclxuICBpZiAoIXNldF9udW0gfHwgIWNvbmRpdGlvbikge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIHNldF9udW0gb3IgY29uZGl0aW9uJyB9KTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyDwn5SNIFN0ZXAgMTogVHJ5IHRvIGZldGNoIGZyb20gRHluYW1vREIgKHZpYSBMYW1iZGEpXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2tsa3d3dGhkbDcuZXhlY3V0ZS1hcGkudXMtZWFzdC0yLmFtYXpvbmF3cy5jb20vQ2hlY2tQcmljZScsIHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHNldF9udW0sIGNvbmRpdGlvbiB9KSxcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcclxuICAgIGxldCBkYXRhOiBhbnk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KTtcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHBhcnNlIEpTT04gZnJvbSBMYW1iZGE6XCIsIGVycik7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBcIkludmFsaWQgSlNPTiBmcm9tIExhbWJkYVwiIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNhbXBsZXMgPSBkYXRhPy5kYXRhPy5wcmljZV9zYW1wbGVzO1xyXG5cclxuICAgIC8vIElmIG5vIHJlc3VsdCBvciBlbXB0eSBzYW1wbGVzLCBmYWxsYmFjayB0byBCcmlja0Vjb25vbXlcclxuICAgIGlmICghcmVzcG9uc2Uub2sgfHwgIXNhbXBsZXMgfHwgc2FtcGxlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdHlwZSBGYWxsYmFja1R5cGUgPSB7XHJcbiAgICAgICAgbWFya2V0UHJpY2U/OiBudW1iZXI7XHJcbiAgICAgICAgcmV0YWlsUHJpY2U/OiB7XHJcbiAgICAgICAgICB1cz86IG51bWJlcjtcclxuICAgICAgICAgIHVrPzogbnVtYmVyO1xyXG4gICAgICAgICAgY2E/OiBudW1iZXI7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBtZXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICB5ZWFyOiBudW1iZXI7XHJcbiAgICAgICAgfTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGxldCBmYWxsYmFjayA9IGF3YWl0IGdldF9yZXRhaWxfdmFsdWUoc2V0X251bSwgY29uZGl0aW9uKSBhcyBGYWxsYmFja1R5cGU7XHJcblxyXG4gICAgICBpZiAoZmFsbGJhY2spIHtcclxuICAgICAgICBsZXQgZmFsbGJhY2tQcmljZSA9IDA7XHJcbiAgICAgICAgaWYgKGZhbGxiYWNrLm1hcmtldFByaWNlICE9IG51bGwpIHtcclxuICAgICAgICAgIGZhbGxiYWNrUHJpY2UgPSBmYWxsYmFjay5tYXJrZXRQcmljZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZmFsbGJhY2tQcmljZSA9PSAwKXtcclxuICAgICAgICAgIGZhbGxiYWNrID0gYXdhaXQgZ2V0X3JldGFpbF92YWx1ZShzZXRfbnVtLCBcIm5ld1wiKSBhcyBGYWxsYmFja1R5cGU7XHJcbiAgICAgICAgICBmYWxsYmFja1ByaWNlID0gZmFsbGJhY2s/Lm1hcmtldFByaWNlID8gZmFsbGJhY2subWFya2V0UHJpY2UgKiAwLjggOiAwO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3Qgc3RvcmVSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2tsa3d3dGhkbDcuZXhlY3V0ZS1hcGkudXMtZWFzdC0yLmFtYXpvbmF3cy5jb20vQ2hlY2tQcmljZScsIHtcclxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIHN0b3JlOiB0cnVlLFxyXG4gICAgICAgICAgICBzZXRfbnVtLFxyXG4gICAgICAgICAgICBjb25kaXRpb24sXHJcbiAgICAgICAgICAgIG5hbWU6IGZhbGxiYWNrLm1ldGEubmFtZSxcclxuICAgICAgICAgICAgeWVhcjogZmFsbGJhY2subWV0YS55ZWFyLFxyXG4gICAgICAgICAgICBwcmljZV9zYW1wbGVzOiBbe1xyXG4gICAgICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdLFxyXG4gICAgICAgICAgICAgIHZhbHVlOiBOdW1iZXIoZmFsbGJhY2tQcmljZS50b0ZpeGVkKDIpKVxyXG4gICAgICAgICAgICB9XVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBzdG9yZVJlc3VsdCA9IGF3YWl0IHN0b3JlUmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgICAgICBtZXNzYWdlOiAnRmFsbGJhY2sgcHJpY2UgdXNlZCcsXHJcbiAgICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICAgIHNldF9udW0sXHJcbiAgICAgICAgICAgIGNvbmRpdGlvbixcclxuICAgICAgICAgICAgbmFtZTogZmFsbGJhY2subWV0YS5uYW1lLFxyXG4gICAgICAgICAgICB5ZWFyOiBmYWxsYmFjay5tZXRhLnllYXIsXHJcbiAgICAgICAgICAgIHByaWNlX3NhbXBsZXM6IFtcclxuICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBOdW1iZXIoZmFsbGJhY2tQcmljZS50b0ZpeGVkKDIpKVxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ1VuYWJsZSB0byBmZXRjaCBmYWxsYmFjayBwcmljZScgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g4pyFIElmIHByaWNlIHNhbXBsZXMgZXhpc3QsIHJldHVybiBub3JtYWwgZGF0YVxyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKGRhdGEpO1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gY2hlY2stcHJpY2UgQVBJOicsIGVycm9yKTtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnU2VydmVyIGVycm9yJyB9KTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImdldF9yZXRhaWxfdmFsdWUiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwic2V0X251bSIsImNvbmRpdGlvbiIsImJvZHkiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsIkpTT04iLCJzdHJpbmdpZnkiLCJyZXNwb25zZVRleHQiLCJ0ZXh0IiwiZGF0YSIsInBhcnNlIiwiZXJyIiwiY29uc29sZSIsInNhbXBsZXMiLCJwcmljZV9zYW1wbGVzIiwib2siLCJsZW5ndGgiLCJmYWxsYmFjayIsImZhbGxiYWNrUHJpY2UiLCJtYXJrZXRQcmljZSIsInN0b3JlUmVzcG9uc2UiLCJzdG9yZSIsIm5hbWUiLCJtZXRhIiwieWVhciIsImRhdGUiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzcGxpdCIsInZhbHVlIiwiTnVtYmVyIiwidG9GaXhlZCIsInN0b3JlUmVzdWx0IiwibWVzc2FnZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/check-price.ts\n");

/***/ }),

/***/ "(api-node)/./utils/retail_fallback.ts":
/*!**********************************!*\
  !*** ./utils/retail_fallback.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get_retail_value: () => (/* binding */ get_retail_value)\n/* harmony export */ });\nasync function get_retail_value(set_num, condition = 'new') {\n    const apiKey = process.env.BRICKECONOMY_API_KEY;\n    const userAgent = process.env.USER_AGENT;\n    const url = `https://www.brickeconomy.com/api/v1/set/${set_num}?currency=USD`;\n    const options = {\n        method: 'GET',\n        headers: {\n            accept: 'application/json',\n            'x-apikey': apiKey || '',\n            'User-Agent': userAgent || ''\n        }\n    };\n    try {\n        const response = await fetch(url, options);\n        const json = await response.json();\n        const data = json.data;\n        if (!data) throw new Error(\"No data returned\");\n        const marketPrice = condition.toLowerCase() === 'new' ? data.current_value_new : condition.toLowerCase() === 'used' ? data.current_value_used : null;\n        return {\n            marketPrice,\n            meta: {\n                name: data.name,\n                set_number: data.set_number,\n                theme: `${data.theme} - ${data.subtheme}`,\n                year: data.year,\n                pieces: data.pieces_count,\n                minifigs: data.minifigs_count,\n                isRetired: data.retired,\n                releaseDate: data.released_date,\n                retiredDate: data.retired_date,\n                retailPrice: {\n                    us: data.retail_price_us,\n                    uk: data.retail_price_uk,\n                    ca: data.retail_price_ca\n                },\n                forecast: {\n                    in2Y: data.forecast_value_new_2_years,\n                    in5Y: data.forecast_value_new_5_years\n                },\n                lastNewSale: data.price_events_new?.[0],\n                lastUsedSale: data.price_events_used?.[0],\n                growth12mo: data.rolling_growth_12months,\n                growth1Y: data.rolling_growth_lastyear\n            }\n        };\n    } catch (err) {\n        console.error(`Error fetching retail value for ${set_num}:`, err);\n        return null;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL3V0aWxzL3JldGFpbF9mYWxsYmFjay50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sZUFBZUEsaUJBQWlCQyxPQUFlLEVBQUVDLFlBQW9CLEtBQUs7SUFDL0UsTUFBTUMsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxvQkFBb0I7SUFDL0MsTUFBTUMsWUFBWUgsUUFBUUMsR0FBRyxDQUFDRyxVQUFVO0lBRXhDLE1BQU1DLE1BQU0sQ0FBQyx3Q0FBd0MsRUFBRVIsUUFBUSxhQUFhLENBQUM7SUFFN0UsTUFBTVMsVUFBVTtRQUNkQyxRQUFRO1FBQ1JDLFNBQVM7WUFDUEMsUUFBUTtZQUNSLFlBQVlWLFVBQVU7WUFDdEIsY0FBY0ksYUFBYTtRQUM3QjtJQUNGO0lBRUEsSUFBSTtRQUNGLE1BQU1PLFdBQVcsTUFBTUMsTUFBTU4sS0FBS0M7UUFDbEMsTUFBTU0sT0FBTyxNQUFNRixTQUFTRSxJQUFJO1FBQ2hDLE1BQU1DLE9BQU9ELEtBQUtDLElBQUk7UUFFdEIsSUFBSSxDQUFDQSxNQUFNLE1BQU0sSUFBSUMsTUFBTTtRQUUzQixNQUFNQyxjQUFjakIsVUFBVWtCLFdBQVcsT0FBTyxRQUM1Q0gsS0FBS0ksaUJBQWlCLEdBQ3RCbkIsVUFBVWtCLFdBQVcsT0FBTyxTQUM1QkgsS0FBS0ssa0JBQWtCLEdBQ3ZCO1FBRUosT0FBTztZQUNMSDtZQUNBSSxNQUFNO2dCQUNKQyxNQUFNUCxLQUFLTyxJQUFJO2dCQUNmQyxZQUFZUixLQUFLUSxVQUFVO2dCQUMzQkMsT0FBTyxHQUFHVCxLQUFLUyxLQUFLLENBQUMsR0FBRyxFQUFFVCxLQUFLVSxRQUFRLEVBQUU7Z0JBQ3pDQyxNQUFNWCxLQUFLVyxJQUFJO2dCQUNmQyxRQUFRWixLQUFLYSxZQUFZO2dCQUN6QkMsVUFBVWQsS0FBS2UsY0FBYztnQkFDN0JDLFdBQVdoQixLQUFLaUIsT0FBTztnQkFDdkJDLGFBQWFsQixLQUFLbUIsYUFBYTtnQkFDL0JDLGFBQWFwQixLQUFLcUIsWUFBWTtnQkFDOUJDLGFBQWE7b0JBQ1hDLElBQUl2QixLQUFLd0IsZUFBZTtvQkFDeEJDLElBQUl6QixLQUFLMEIsZUFBZTtvQkFDeEJDLElBQUkzQixLQUFLNEIsZUFBZTtnQkFDMUI7Z0JBQ0FDLFVBQVU7b0JBQ1JDLE1BQU05QixLQUFLK0IsMEJBQTBCO29CQUNyQ0MsTUFBTWhDLEtBQUtpQywwQkFBMEI7Z0JBQ3ZDO2dCQUNBQyxhQUFhbEMsS0FBS21DLGdCQUFnQixFQUFFLENBQUMsRUFBRTtnQkFDdkNDLGNBQWNwQyxLQUFLcUMsaUJBQWlCLEVBQUUsQ0FBQyxFQUFFO2dCQUN6Q0MsWUFBWXRDLEtBQUt1Qyx1QkFBdUI7Z0JBQ3hDQyxVQUFVeEMsS0FBS3lDLHVCQUF1QjtZQUN4QztRQUNGO0lBQ0YsRUFBRSxPQUFPQyxLQUFLO1FBQ1pDLFFBQVFDLEtBQUssQ0FBQyxDQUFDLGdDQUFnQyxFQUFFNUQsUUFBUSxDQUFDLENBQUMsRUFBRTBEO1FBQzdELE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGx1a2VjXFxPbmVEcml2ZVxcRGVza3RvcFxcQVdTIEhhY2thdGhvblxcdXRpbHNcXHJldGFpbF9mYWxsYmFjay50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0X3JldGFpbF92YWx1ZShzZXRfbnVtOiBzdHJpbmcsIGNvbmRpdGlvbjogc3RyaW5nID0gJ25ldycpIHtcclxuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5CUklDS0VDT05PTVlfQVBJX0tFWTtcclxuICBjb25zdCB1c2VyQWdlbnQgPSBwcm9jZXNzLmVudi5VU0VSX0FHRU5UO1xyXG5cclxuICBjb25zdCB1cmwgPSBgaHR0cHM6Ly93d3cuYnJpY2tlY29ub215LmNvbS9hcGkvdjEvc2V0LyR7c2V0X251bX0/Y3VycmVuY3k9VVNEYDtcclxuXHJcbiAgY29uc3Qgb3B0aW9ucyA9IHtcclxuICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAneC1hcGlrZXknOiBhcGlLZXkgfHwgJycsXHJcbiAgICAgICdVc2VyLUFnZW50JzogdXNlckFnZW50IHx8ICcnXHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCBvcHRpb25zKTtcclxuICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XHJcbiAgICBjb25zdCBkYXRhID0ganNvbi5kYXRhO1xyXG5cclxuICAgIGlmICghZGF0YSkgdGhyb3cgbmV3IEVycm9yKFwiTm8gZGF0YSByZXR1cm5lZFwiKTtcclxuXHJcbiAgICBjb25zdCBtYXJrZXRQcmljZSA9IGNvbmRpdGlvbi50b0xvd2VyQ2FzZSgpID09PSAnbmV3J1xyXG4gICAgICA/IGRhdGEuY3VycmVudF92YWx1ZV9uZXdcclxuICAgICAgOiBjb25kaXRpb24udG9Mb3dlckNhc2UoKSA9PT0gJ3VzZWQnXHJcbiAgICAgID8gZGF0YS5jdXJyZW50X3ZhbHVlX3VzZWRcclxuICAgICAgOiBudWxsO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG1hcmtldFByaWNlLFxyXG4gICAgICBtZXRhOiB7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIHNldF9udW1iZXI6IGRhdGEuc2V0X251bWJlcixcclxuICAgICAgICB0aGVtZTogYCR7ZGF0YS50aGVtZX0gLSAke2RhdGEuc3VidGhlbWV9YCxcclxuICAgICAgICB5ZWFyOiBkYXRhLnllYXIsXHJcbiAgICAgICAgcGllY2VzOiBkYXRhLnBpZWNlc19jb3VudCxcclxuICAgICAgICBtaW5pZmlnczogZGF0YS5taW5pZmlnc19jb3VudCxcclxuICAgICAgICBpc1JldGlyZWQ6IGRhdGEucmV0aXJlZCxcclxuICAgICAgICByZWxlYXNlRGF0ZTogZGF0YS5yZWxlYXNlZF9kYXRlLFxyXG4gICAgICAgIHJldGlyZWREYXRlOiBkYXRhLnJldGlyZWRfZGF0ZSxcclxuICAgICAgICByZXRhaWxQcmljZToge1xyXG4gICAgICAgICAgdXM6IGRhdGEucmV0YWlsX3ByaWNlX3VzLFxyXG4gICAgICAgICAgdWs6IGRhdGEucmV0YWlsX3ByaWNlX3VrLFxyXG4gICAgICAgICAgY2E6IGRhdGEucmV0YWlsX3ByaWNlX2NhXHJcbiAgICAgICAgfSxcclxuICAgICAgICBmb3JlY2FzdDoge1xyXG4gICAgICAgICAgaW4yWTogZGF0YS5mb3JlY2FzdF92YWx1ZV9uZXdfMl95ZWFycyxcclxuICAgICAgICAgIGluNVk6IGRhdGEuZm9yZWNhc3RfdmFsdWVfbmV3XzVfeWVhcnNcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxhc3ROZXdTYWxlOiBkYXRhLnByaWNlX2V2ZW50c19uZXc/LlswXSxcclxuICAgICAgICBsYXN0VXNlZFNhbGU6IGRhdGEucHJpY2VfZXZlbnRzX3VzZWQ/LlswXSxcclxuICAgICAgICBncm93dGgxMm1vOiBkYXRhLnJvbGxpbmdfZ3Jvd3RoXzEybW9udGhzLFxyXG4gICAgICAgIGdyb3d0aDFZOiBkYXRhLnJvbGxpbmdfZ3Jvd3RoX2xhc3R5ZWFyXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciBmZXRjaGluZyByZXRhaWwgdmFsdWUgZm9yICR7c2V0X251bX06YCwgZXJyKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZ2V0X3JldGFpbF92YWx1ZSIsInNldF9udW0iLCJjb25kaXRpb24iLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiQlJJQ0tFQ09OT01ZX0FQSV9LRVkiLCJ1c2VyQWdlbnQiLCJVU0VSX0FHRU5UIiwidXJsIiwib3B0aW9ucyIsIm1ldGhvZCIsImhlYWRlcnMiLCJhY2NlcHQiLCJyZXNwb25zZSIsImZldGNoIiwianNvbiIsImRhdGEiLCJFcnJvciIsIm1hcmtldFByaWNlIiwidG9Mb3dlckNhc2UiLCJjdXJyZW50X3ZhbHVlX25ldyIsImN1cnJlbnRfdmFsdWVfdXNlZCIsIm1ldGEiLCJuYW1lIiwic2V0X251bWJlciIsInRoZW1lIiwic3VidGhlbWUiLCJ5ZWFyIiwicGllY2VzIiwicGllY2VzX2NvdW50IiwibWluaWZpZ3MiLCJtaW5pZmlnc19jb3VudCIsImlzUmV0aXJlZCIsInJldGlyZWQiLCJyZWxlYXNlRGF0ZSIsInJlbGVhc2VkX2RhdGUiLCJyZXRpcmVkRGF0ZSIsInJldGlyZWRfZGF0ZSIsInJldGFpbFByaWNlIiwidXMiLCJyZXRhaWxfcHJpY2VfdXMiLCJ1ayIsInJldGFpbF9wcmljZV91ayIsImNhIiwicmV0YWlsX3ByaWNlX2NhIiwiZm9yZWNhc3QiLCJpbjJZIiwiZm9yZWNhc3RfdmFsdWVfbmV3XzJfeWVhcnMiLCJpbjVZIiwiZm9yZWNhc3RfdmFsdWVfbmV3XzVfeWVhcnMiLCJsYXN0TmV3U2FsZSIsInByaWNlX2V2ZW50c19uZXciLCJsYXN0VXNlZFNhbGUiLCJwcmljZV9ldmVudHNfdXNlZCIsImdyb3d0aDEybW8iLCJyb2xsaW5nX2dyb3d0aF8xMm1vbnRocyIsImdyb3d0aDFZIiwicm9sbGluZ19ncm93dGhfbGFzdHllYXIiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./utils/retail_fallback.ts\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fcheck-price&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Ccheck-price.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();